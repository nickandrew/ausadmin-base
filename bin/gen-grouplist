#!/bin/bash
#	@(#) bin/gen-grouplist - Create newsgroup list
#
# $Source$
# $Revision$
# $Date$

umask 022

cd $AUSADMIN_HOME

bin/gengrouplist.pl > tmp/grouplist.$$
s=$?
if [ $s -ne 0 ] ; then
	echo "bin/gengrouplist.pl returned status $s - fatal"
	rm -f tmp/grouplist.$$
	exit 2
fi

bin/pgp-sign < tmp/grouplist.$$ > tmp/signed-grouplist.$$
s=$?
if [ $s -ne 0 ] ; then
	echo "pgp-sign returned status $s - fatal"
	rm -f tmp/grouplist.$$ tmp/signed-grouplist.$$
	exit 4
fi

rm -f tmp/grouplist.$$

# Replace the current version with the latest

mv tmp/signed-grouplist.$$ data/grouplist.msg

echo "Done. Post when ready with bin/post-grouplist"

exit 0
